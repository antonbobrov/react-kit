"use strict";(self.webpackChunk_anton_bobrov_react_components=self.webpackChunk_anton_bobrov_react_components||[]).push([[916],{"./src/utils/prefixedClassName.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function prefixedClassName(className){return`rkc-${className}`}__webpack_require__.d(__webpack_exports__,{e:()=>prefixedClassName})},"./src/utils/prefixedClassNames.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>prefixedClasNames});var classnames__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../common/temp/node_modules/.pnpm/classnames@2.3.2/node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_0__),_anton_bobrov_react_hooks__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../react-hooks/lib/esm/utils/types/isString.js"),_prefixedClassName__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/utils/prefixedClassName.ts");function prefixedClasNames(...classNames){return classnames__WEBPACK_IMPORTED_MODULE_0___default()(classNames.map((value=>(0,_anton_bobrov_react_hooks__WEBPACK_IMPORTED_MODULE_1__.H)(value)?(0,_prefixedClassName__WEBPACK_IMPORTED_MODULE_2__.e)(value):"")))}},"../react-hooks/lib/esm/hooks/useEvent.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{z:()=>useEvent});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../common/temp/node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),__spreadArray=function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},useEvent=function(callback){var callbackRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(callback);return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){callbackRef.current=callback}),[callback]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useCallback)((function(){for(var _a,args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return null===(_a=callbackRef.current)||void 0===_a?void 0:_a.call.apply(_a,__spreadArray([callbackRef],args,!1))}),[])}},"../react-hooks/lib/esm/hooks/usePropState.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>usePropState});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../common/temp/node_modules/.pnpm/react@18.2.0/node_modules/react/index.js");function usePropState(prop){var _a=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(prop),state=_a[0],setState=_a[1];return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){setState(prop)}),[prop]),[state,setState]}},"../react-hooks/lib/esm/utils/data/times.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function times(callback,count){for(var index=0,list=[];index<count;)list.push(callback(index,count)),index+=1;return list}__webpack_require__.d(__webpack_exports__,{D:()=>times})},"../react-hooks/lib/esm/utils/types/isString.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function isString(value){return"string"==typeof value}__webpack_require__.d(__webpack_exports__,{H:()=>isString})},"../react-hooks/lib/esm/utils/types/isUndefined.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function isUndefined(value){return void 0===value}__webpack_require__.d(__webpack_exports__,{o:()=>isUndefined})},"./src/components/ScrollView/ScrollView.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>ScrollView_stories});var react=__webpack_require__("../../common/temp/node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),usePropState=__webpack_require__("../react-hooks/lib/esm/hooks/usePropState.js"),times=__webpack_require__("../react-hooks/lib/esm/utils/data/times.js"),esm=__webpack_require__("../../common/temp/node_modules/.pnpm/vevet@4.1.0_typescript@4.8.2/node_modules/vevet/lib/esm/index.js"),Component=__webpack_require__("../../common/temp/node_modules/.pnpm/vevet@4.1.0_typescript@4.8.2/node_modules/vevet/lib/esm/base/Component/index.js");var clamp=__webpack_require__("../../common/temp/node_modules/.pnpm/vevet@4.1.0_typescript@4.8.2/node_modules/vevet/lib/esm/utils/math/clamp.js"),normalizedTimeoutCallback=__webpack_require__("../../common/temp/node_modules/.pnpm/vevet@4.1.0_typescript@4.8.2/node_modules/vevet/lib/esm/utils/common/normalizedTimeoutCallback.js"),getApp=__webpack_require__("../../common/temp/node_modules/.pnpm/vevet@4.1.0_typescript@4.8.2/node_modules/vevet/lib/esm/utils/internal/getApp.js");class ScrollView extends Component.w{_getDefaultProps(){return Object.assign(Object.assign({},super._getDefaultProps()),{intersectionRoot:null,isEnabled:!0,rootMargin:.05,states:"in",classToToggle:"viewed",hasDelay:!0,maxDelay:1e3,direction:"vertical",viewportTarget:"any",resizeDebounce:0})}get isFirstStart(){return this._isFirstStart}get elements(){return this._elements}constructor(initialProps,canInit=!0){super(initialProps,!1),this._isFirstStart=!0,this._elements=[],this._isIntersectionObserverSupported=function isIntersectionObserverSupported(){return"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype}(),canInit&&this.init()}_init(){super._init(),this._setEvents()}_onPropsMutate(){super._onPropsMutate(),this.resize()}_setEvents(){const{viewportTarget,resizeDebounce}=this.props;this.resize(),this.addViewportCallback(viewportTarget,(()=>this.resize()),{timeout:resizeDebounce})}resize(){this._removeViewEvents(),this.props.isEnabled&&this._setViewEvents()}get rootBounding(){const{props}=this;if(props.intersectionRoot){const bounding=props.intersectionRoot.getBoundingClientRect();return{top:bounding.top,left:bounding.left,width:bounding.width,height:bounding.height}}const{viewport}=(0,getApp.M)();return{top:0,left:0,width:viewport.width,height:viewport.height}}_setViewEvents(){if(!this._isIntersectionObserverSupported)return;const{rootBounding,isFirstStart,props}=this,xMargin=isFirstStart?0:rootBounding.width*props.rootMargin*-1,yMargin=isFirstStart?0:rootBounding.height*props.rootMargin*-1;this._intersectionObserverIn=new IntersectionObserver((data=>this._handleIntersectionIn(data)),{root:props.intersectionRoot,threshold:0,rootMargin:`0px ${xMargin}px ${yMargin}px 0px`}),this.elements.forEach((element=>{var _a;return null===(_a=this._intersectionObserverIn)||void 0===_a?void 0:_a.observe(element)})),"inout"===props.states&&(this._intersectionObserverOut=new IntersectionObserver((data=>this._handleIntersectionOut(data)),{root:props.intersectionRoot,threshold:0,rootMargin:"0px 0px 0px 0px"}),this.elements.forEach((element=>{var _a;return null===(_a=this._intersectionObserverOut)||void 0===_a?void 0:_a.observe(element)})))}_removeViewEvents(){var _a,_b;null===(_a=this._intersectionObserverIn)||void 0===_a||_a.disconnect(),this._intersectionObserverIn=void 0,null===(_b=this._intersectionObserverOut)||void 0===_b||_b.disconnect(),this._intersectionObserverOut=void 0}_handleIntersectionIn(data){data.forEach((entry=>{if(!entry.isIntersecting)return;const element=entry.target,delay=this._getElementDelay(element);this._handleInOut(element,!0,delay),"in"===this.props.states&&this.removeElement(element)})),this.isFirstStart&&(this._isFirstStart=!1,this.resize())}_getElementDelay(element){const{isFirstStart,props}=this,rootBounding=!!isFirstStart&&this.rootBounding;if(!isFirstStart||!rootBounding||!props.hasDelay)return 0;const bounding=element.getBoundingClientRect();return(0,clamp.u)("horizontal"===props.direction?(bounding.left-rootBounding.left)/rootBounding.width:(bounding.top-rootBounding.top)/rootBounding.height,[0,1])*props.maxDelay}_handleIntersectionOut(data){data.forEach((entry=>{if(entry.isIntersecting)return;const element=entry.target;this._handleInOut(element,!1)}))}_handleInOut(elementProp,isInViewport,delay=0){const{classToToggle}=this.props,element=elementProp;element.isScrollViewIn&&isInViewport||!element.isScrollViewIn&&!isInViewport||(element.isScrollViewIn=isInViewport,classToToggle&&(0,normalizedTimeoutCallback.h)((()=>{element.classList.toggle(classToToggle,isInViewport)}),delay),isInViewport?(0,normalizedTimeoutCallback.h)((()=>{this.callbacks.tbt("in",{element})}),delay):(0,normalizedTimeoutCallback.h)((()=>{this.callbacks.tbt("out",{element})}),delay))}addElement(elementProp){var _a,_b;const element=elementProp;return element.isScrollViewIn=void 0,this._isIntersectionObserverSupported?(this._elements.push(element),null===(_a=this._intersectionObserverIn)||void 0===_a||_a.observe(element),null===(_b=this._intersectionObserverOut)||void 0===_b||_b.observe(element)):this._handleInOut(element,!0),{remove:()=>this.removeElement(element)}}removeElement(elementProp){var _a,_b;const element=elementProp;null===(_a=this._intersectionObserverIn)||void 0===_a||_a.unobserve(element),null===(_b=this._intersectionObserverOut)||void 0===_b||_b.unobserve(element),element.isScrollViewIn=void 0,this._elements=this._elements.filter((el=>el!==element))}removeElements(){this._elements.forEach((element=>this.removeElement(element))),this._elements=[]}_destroy(){super._destroy(),this._removeViewEvents()}}var isUndefined=__webpack_require__("../react-hooks/lib/esm/utils/types/isUndefined.js"),use_deep_compare_effect_esm=__webpack_require__("../../common/temp/node_modules/.pnpm/use-deep-compare-effect@1.8.1_react@18.2.0/node_modules/use-deep-compare-effect/dist/use-deep-compare-effect.esm.js");const defaultValue={scrollView:void 0},ScrollViewContext=(0,react.createContext)(defaultValue);var jsx_runtime=__webpack_require__("../../common/temp/node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js");const Provider=({children,instanceKey,intersectionRoot=null,states="in",hasDelay=!0,maxDelay=1e3,direction="vertical",viewportTarget,resizeDebounce=0,isEnabled=!1,...props})=>{const[scrollView,setScrollView]=(0,react.useState)(),vevetRef=(0,react.useRef)(esm.vevet),changeableProps={...props,isEnabled},initialChangeablePropsRef=(0,react.useRef)(changeableProps);(0,react.useEffect)((()=>{if(!vevetRef.current||(0,isUndefined.o)(instanceKey))return;const instance=new ScrollView({...initialChangeablePropsRef.current,intersectionRoot,states,hasDelay,maxDelay,direction,viewportTarget:viewportTarget||(esm.vevet.isMobile?"width":"any"),resizeDebounce});return setScrollView(instance),()=>{setScrollView(void 0),instance.destroy()}}),[instanceKey,direction,hasDelay,intersectionRoot,maxDelay,resizeDebounce,states,viewportTarget]);const contextValue=(0,react.useMemo)((()=>({scrollView})),[scrollView]);return(0,react.useEffect)((()=>{scrollView&&scrollView.changeProps(changeableProps)}),[scrollView,(0,use_deep_compare_effect_esm.Uf)(changeableProps)]),(0,jsx_runtime.jsx)(ScrollViewContext.Provider,{value:contextValue,children})};Provider.displayName="Provider";try{Provider.displayName="Provider",Provider.__docgenInfo={description:"ScrollView provider.\nScrollView lets you detect visible elements in viewport",displayName:"Provider",props:{instanceKey:{defaultValue:null,description:"Used to destory the previous instance and create a new one",name:"instanceKey",required:!0,type:{name:"string | number"}},isEnabled:{defaultValue:{value:"false"},description:"Enable or disable the ScrollView",name:"isEnabled",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ScrollView/Provider.tsx#Provider"]={docgenInfo:Provider.__docgenInfo,name:"Provider",path:"src/components/ScrollView/Provider.tsx#Provider"})}catch(__react_docgen_typescript_loader_error){}var classnames=__webpack_require__("../../common/temp/node_modules/.pnpm/classnames@2.3.2/node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),prefixedClassNames=__webpack_require__("./src/utils/prefixedClassNames.ts"),useEvent=__webpack_require__("../react-hooks/lib/esm/hooks/useEvent.js");const Element=({viewClassName="view",viewedClassName="viewed",onIn,onOut,isDisabled,inDelay,animation,children})=>{const ref=(0,react.useRef)(null);(0,react.useImperativeHandle)(children.ref,(()=>ref.current));const[isViewed,setIsViewed]=(0,react.useState)(!1);!function useScrollView({ref,onIn:onInProp,onOut:onOutProp,isDisabled,inDelay}){const{scrollView}=(0,react.useContext)(ScrollViewContext),onIn=(0,useEvent.z)(onInProp),onOut=(0,useEvent.z)(onOutProp);(0,react.useEffect)((()=>{const{current:element}=ref;if(isDisabled||!element||!scrollView)return;let timeout;const inCallback=scrollView.addCallback("in",(data=>{data.element===element&&(inDelay?timeout=setTimeout((()=>onIn?.()),inDelay):onIn?.())})),outCallback=scrollView.addCallback("out",(data=>{data.element===element&&onOut?.()})),observer=scrollView.addElement(element);return()=>{inCallback.remove(),outCallback.remove(),observer.remove(),timeout&&clearTimeout(timeout)}}),[inDelay,isDisabled,onIn,onOut,ref,scrollView])}({ref,onIn(){setIsViewed(!0),onIn?.()},onOut(){setIsViewed(!1),onOut?.()},isDisabled,inDelay});const classNames=(0,prefixedClassNames.I)("scroll-view",animation,isViewed&&"viewed");return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,react.cloneElement)(children,{className:classnames_default()(children.props.className,classNames,viewClassName,isViewed&&viewedClassName),ref})})};try{Element.displayName="Element",Element.__docgenInfo={description:"ScrollView element.\nWrap some element to detect when it appears or disappears from the page viewport",displayName:"Element",props:{viewClassName:{defaultValue:{value:"view"},description:"",name:"viewClassName",required:!1,type:{name:"string"}},viewedClassName:{defaultValue:{value:"viewed"},description:"",name:"viewedClassName",required:!1,type:{name:"string"}},isDisabled:{defaultValue:null,description:"",name:"isDisabled",required:!1,type:{name:"boolean"}},animation:{defaultValue:null,description:"",name:"animation",required:!1,type:{name:"enum",value:[{value:'"fadeIn"'},{value:'"fadeInUp"'}]}},inDelay:{defaultValue:null,description:"Delay before `onIn` callback",name:"inDelay",required:!1,type:{name:"number"}},onIn:{defaultValue:null,description:"Event when element is in viewport",name:"onIn",required:!1,type:{name:"(() => void)"}},onOut:{defaultValue:null,description:"Event when element is out of viewport",name:"onOut",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/ScrollView/Element.tsx#Element"]={docgenInfo:Element.__docgenInfo,name:"Element",path:"src/components/ScrollView/Element.tsx#Element"})}catch(__react_docgen_typescript_loader_error){}Provider.displayName="ScrollView.Provider",Element.displayName="ScrollView.Element";const ScrollView_ScrollView={Provider,Element},ScrollView_stories={title:"Scroll/ScrollVew",component:ScrollView_ScrollView.Provider,tags:["autodocs"]},Default=(({isEnabled:isEnabledProp,...props})=>{const[isEnabled,setIsEnabled]=(0,usePropState.W)(isEnabledProp);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("button",{type:"button",onClick:()=>setIsEnabled(!0),children:"Enable ScrollView"}),(0,jsx_runtime.jsx)(ScrollView_ScrollView.Provider,{isEnabled,...props,children:(0,jsx_runtime.jsx)("div",{children:(0,times.D)((index=>(0,jsx_runtime.jsx)(ScrollView_ScrollView.Element,{animation:"fadeInUp",children:(0,jsx_runtime.jsx)("div",{style:{marginTop:10},children:"Element"})},index)),100)})})]})}).bind({});Default.args={instanceKey:0},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'({\n  isEnabled: isEnabledProp,\n  ...props\n}) => {\n  const [isEnabled, setIsEnabled] = usePropState(isEnabledProp);\n  return <>\r\n      <button type="button" onClick={() => setIsEnabled(true)}>\r\n        Enable ScrollView\r\n      </button>\r\n\r\n      <ScrollView.Provider isEnabled={isEnabled} {...props}>\r\n        <div>\r\n          {times(index => <ScrollView.Element key={index} animation="fadeInUp">\r\n                <div style={{\n            marginTop: 10\n          }}>Element</div>\r\n              </ScrollView.Element>, 100)}\r\n        </div>\r\n      </ScrollView.Provider>\r\n    </>;\n}',...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]},"../../common/temp/node_modules/.pnpm/vevet@4.1.0_typescript@4.8.2/node_modules/vevet/lib/esm/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{vevet:()=>vevet});var _utils_internal_getApp__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../common/temp/node_modules/.pnpm/vevet@4.1.0_typescript@4.8.2/node_modules/vevet/lib/esm/utils/internal/getApp.js");const vevet="undefined"!=typeof window?(0,_utils_internal_getApp__WEBPACK_IMPORTED_MODULE_0__.M)():void 0},"../../common/temp/node_modules/.pnpm/vevet@4.1.0_typescript@4.8.2/node_modules/vevet/lib/esm/utils/math/clamp.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function clamp(value,scope=[0,1]){return value<scope[0]?scope[0]:value>scope[1]?scope[1]:value}__webpack_require__.d(__webpack_exports__,{u:()=>clamp})}}]);